---
import MainLayout from "@core/layouts/MainLayout.astro"
import properties from "@features/properties/data/properties.json"
import PropertyGallery from "@features/properties/components/PropertyGallery.astro"
import { envConfig } from "src/config/env"

export async function getStaticPaths() {
	return properties.map((prop) => ({
		params: { slug: prop.slug },
		props: { property: prop },
	}))
}

const { property } = Astro.props

const phone = "51992096134" // Perú
const name = property?.title
const url = `${envConfig?.clientUrl}/propiedades/${property?.slug}`
const mensaje = encodeURIComponent(`
Hola, estoy interesado en este inmueble:
${name}

${url}
`)
const link = `https://wa.me/${phone}?text=${mensaje}`

console.log(envConfig)
---

<MainLayout title="Propiedades">
	<div class="h-14 lg:h-[66px] sticky top-0 w-full bg-midnight-blue"></div>

	<div class="container py-4 overflow-hidden">
		<nav class="flex" aria-label="Breadcrumb">
			<ol class="inline-flex items-center space-x-1 md:space-x-3">
				<li class="inline-flex items-center">
					<a
						href="/"
						class="inline-flex items-center text-sm font-medium text-[#5193e6] hover:text-[#0c2647]"
					>
						<i class="fas fa-home mr-2"></i>Inicio
					</a>
				</li>
				<li>
					<div class="flex items-center">
						<i class="fas fa-chevron-right text-gray-400 mx-2"></i>
						<a
							href="/propiedades"
							class="ml-1 text-sm font-medium text-[#5193e6] hover:text-[#0c2647] md:ml-2"
						>
							Propiedades
						</a>
					</div>
				</li>
				<li aria-current="page">
					<div class="flex items-center">
						<i class="fas fa-chevron-right text-gray-400 mx-2"></i>
						<span
							class="ml-1 text-sm font-medium text-gray-500 md:ml-2 max-w-[150px] md:max-w-full truncate block"
						>
							{property?.title}
						</span>
					</div>
				</li>
			</ol>
		</nav>
	</div>

	<PropertyGallery images={property.images} />

	<!-- Property Info -->
	<section class="container grid grid-cols-1 lg:grid-cols-[1fr_380px] gap-8">
		<div class="l2">
			<!-- Title and location -->
			<div class="mb-6">
				<h1 class="text-xl md:text-3xl lg:text-4xl font-bold text-[#0c2647] mb-2">{property?.title}</h1>
				<div class="flex items-center text-gray-600">
					<i class="fas fa-map-marker-alt text-[#fe7f32] mr-2"></i>
					<span>{property?.location}</span>
				</div>
			</div>

			<!-- Highlights -->
			<div class="bg-[#f4efea] rounded-xl p-6 mb-8 shadow-sm">
				<div class="grid grid-cols-2 md:grid-cols-4 gap-4">
					<div class="text-center">
						<div
							class="bg-[#5193e6] bg-opacity-20 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-2"
						>
							<i class="fas fa-ruler-combined text-white text-xl"></i>
						</div>
						<p class="text-sm text-gray-600">Área total</p>
						<p class="font-bold text-[#0c2647]">{property?.area} m²</p>
					</div>
					<div class="text-center">
						<div
							class="bg-[#5193e6] bg-opacity-20 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-2"
						>
							<i class="fas fa-bed text-white text-xl"></i>
						</div>
						<p class="text-sm text-gray-600">Dormitorios</p>
						<p class="font-bold text-[#0c2647]">{property?.rooms}</p>
					</div>
					<div class="text-center">
						<div
							class="bg-[#5193e6] bg-opacity-20 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-2"
						>
							<i class="fas fa-bath text-white text-xl"></i>
						</div>
						<p class="text-sm text-gray-600">Baños</p>
						<p class="font-bold text-[#0c2647]">{property?.bathrooms}</p>
					</div>
					<div class="text-center">
						<div
							class="bg-[#5193e6] bg-opacity-20 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-2"
						>
							<i class="fas fa-building text-white text-xl"></i>
						</div>
						<p class="text-sm text-gray-600">Pisos</p>
						<p class="font-bold text-[#0c2647]">{property?.floors}</p>
					</div>
				</div>
			</div>

			<!-- Description -->
			<div class="mb-8">
				<h2 class="text-xl md:text-2xl font-bold text-[#0c2647] mb-4">Descripción de la propiedad</h2>
				<div class="prose max-w-none">
					<p class="mb-4 text-gray-700">{property?.description}</p>
				</div>
			</div>

			<!-- Features -->
			<div class="mb-8">
				<h2 class="text-xl md:text-2xl font-bold text-[#0c2647] mb-4">Características destacadas</h2>
				<div class="flex flex-wrap gap-3">
					{
						property?.highlights.map((highlight) => (
							<div class="feature-badge flex items-center text-gray-700">
								<div class="bg-cornflower-blue/20 flex justify-center items-center h-10 aspect-square text-white p-2 rounded-full mr-4 shadow-md">
									<i class="fas fa-check text-cornflower-blue" />
								</div>
								{highlight}
							</div>
						))
					}
				</div>
			</div>

			<div class="bg-white-smoke px-4 py-6 mb-4">
				<p class="font-semibold text-lg">{property?.tagline}</p>
			</div>

			<div class="flex flex-col md:flex-row items-center justify-between gap-2">
				<p class="font-medium text-center md:text-left">
					{property?.contact.message}
				</p>
				<a
					href={link}
					target="_blank"
					rel="noopener noreferrer"
					class="inline-flex items-center gap-2 bg-midnight-blue text-white font-semibold px-6 py-3 rounded-lg hover:bg-[#0c2647]/90 transition"
				>
					<i class="fab fa-whatsapp text-xl"></i>
					WhatsApp
				</a>
			</div>
		</div>

		<!-- Sidebar -->
		<div class="w-full max-w-md mx-auto">
			<div class="bg-white rounded-xl shadow-lg p-6 sticky top-28">
				<div class="text-center mb-6">
					<p class="text-gray-600 mb-1">Precio de venta</p>
					<p class="text-3xl font-bold text-[#0c2647]">{property?.price}</p>
				</div>

				<form class="space-y-4">
					<div>
						<label for="name" class="block text-sm font-medium text-gray-700 mb-1">Nombre completo</label>
						<input
							type="text"
							id="name"
							class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5193e6] focus:border-[#5193e6]"
						/>
					</div>
					<div>
						<label for="email" class="block text-sm font-medium text-gray-700 mb-1"
							>Correo electrónico</label
						>
						<input
							type="email"
							id="email"
							class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5193e6] focus:border-[#5193e6]"
						/>
					</div>
					<div>
						<label for="phone" class="block text-sm font-medium text-gray-700 mb-1">Teléfono</label>
						<input
							type="tel"
							id="phone"
							class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5193e6] focus:border-[#5193e6]"
						/>
					</div>
					<div>
						<label for="message" class="block text-sm font-medium text-gray-700 mb-1">Mensaje</label>
						<textarea
							id="message"
							rows="3"
							class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5193e6] focus:border-[#5193e6]"
						></textarea>
					</div>
					<button
						type="submit"
						class="w-full bg-[#fe7f32] hover:bg-[#e6732d] text-white font-bold py-3 px-6 rounded-lg transition shadow-md hover:shadow-lg"
					>
						<i class="fas fa-paper-plane mr-2"></i>Enviar mensaje
					</button>
				</form>
			</div>
		</div>
	</section>

	<div class="container h-16 w-full"></div>
</MainLayout>
